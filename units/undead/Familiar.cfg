#textdomain wesnoth-trow
[unit_type]
    id=Familiar
    name= _ "Familiar"
    race=undead
    image="units/undead/familiar-3.png"
    profile="portraits/familiar.png"
    hitpoints=36
    movement_type=smallfly
    movement=8
    experience=100
    level=2
    alignment=chaotic
    advances_to=null
    {AMLA_DEFAULT}
    cost=40
    usage=scout
    description= _ "Powerful magic users sometimes have familiars, creatures which have had a spirit or minor demon drawn into them. A familiar may act as a spy or messenger for its master."
    die_sound=bat-flapping.wav
    [portrait]
        size=400
        side="left"
        mirror="false"
        image="portraits/familiar.png"
    [/portrait]
    [portrait]
        size=400
        side="right"
        mirror="true"
        image="portraits/familiar.png"
    [/portrait]
    # Use undeadfoot resistances despite the smallfly movement values
    [resistance]
        blade=90
        pierce=70
        impact=110
        fire=120
        cold=40
        arcane=140
    [/resistance]
    [abilities]
        {ABILITY_FAMILIAR}
    [/abilities]
    [attack]
        name=bite
        description= _"bite"
        icon=attacks/fangs-animal.png
        [specials]
            {WEAPON_SPECIAL_DRAIN}
        [/specials] 
        type=blade
        range=melee
        damage=5
        number=5
    [/attack]
    [defend]
        [if]
            hits=miss
            offset=0.0~-0.15,-0.15~0.0
        [/if]
        start_time=-126
        [frame]
            image="units/undead/familiar-3.png:1,units/undead/familiar-4.png:250,units/undead/familiar-3.png:1"
        [/frame]
        [if]
            hits=hit
            hit_sound_start_time=-26
            [hit_sound_frame]
                sound=familiar-teeth.ogg
            [/hit_sound_frame]
        [/if]
    [/defend]
    [standing_anim]
        layer=60
        start_time=0
        [frame]
            image="units/undead/familiar-[3~1,2~5,4].png:[50,60,80,60,50,60,80,60]"
        [/frame]
    [/standing_anim]
    [movement_anim]
        start_time=0
        [frame]
            image="units/undead/familiar-[3~1,2~5,4].png:[50,60,80,60,50,60,80,60]"
        [/frame]
    [/movement_anim]
    [attack_anim]
        [filter_attack]
            name=bite
        [/filter_attack]

        offset=0.0~0.9:200,0.9~0.0:160
        start_time=-200

        [frame]
            image="units/undead/familiar-[3~2].png:30"
        [/frame]
        [frame]
            image="units/undead/familiar-1.png:30"
            sound=bat-flapping.wav
        [/frame]
        [frame]
            image="units/undead/familiar-[2~4,3,2,3].png:[30*2,70,50*2,40]"
        [/frame]
        {SOUND:HIT_AND_MISS bite-small.ogg {SOUND_LIST:MISS} -50}
    [/attack_anim]
    [animation]
        apply_to=pre_teleport
        start_time=-1200

        teleport_sparkle_1_start_time=-1200
        teleport_sparkle_2_start_time=-1000
        teleport_sparkle_3_start_time=-800

        [teleport_sparkle_1_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=-10
            halo_y=30~-30
        [/teleport_sparkle_1_frame]
        [teleport_sparkle_2_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=0
            halo_y=40~-40
        [/teleport_sparkle_2_frame]
        [teleport_sparkle_3_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=10
            halo_y=30~-30
        [/teleport_sparkle_3_frame]

        [frame]
            image="misc/blank-hex.png:300"
        [/frame]
    [/animation]

    [animation]
        apply_to=post_teleport
        start_time=-1200

        teleport_sparkle_1_start_time=-1200
        teleport_sparkle_2_start_time=-1000
        teleport_sparkle_3_start_time=-800

        [teleport_sparkle_1_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=10
            halo_y=-30~30
        [/teleport_sparkle_1_frame]
        [teleport_sparkle_2_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=0
            halo_y=-40~40
        [/teleport_sparkle_2_frame]
        [teleport_sparkle_3_frame]
            duration=800
            halo=misc/blank-hex.png:1,halo/undead/dark-magic-[6,5,1~6].png,misc/blank-hex.png:1
            halo_x=-10
            halo_y=-30~30
        [/teleport_sparkle_3_frame]
        [frame]
            image="misc/blank-hex.png:300"
        [/frame]
    [/animation]
[/unit_type]
